<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Appartement Cosy à Paris - AirLockUnlock</title>
    <style>
        /* Ton style CSS inchangé ici */
        /* ... (tout le CSS reste pareil, pas modifié pour garder le design) */
    </style>
</head>
<body>

<header>
    <div class="logo">
        <img src="img/logo (2).png" alt="Logo AirLockUnlock">
        <span>AirLockUnlock</span>
    </div>
    <nav>
        <a href="accueil.html">Accueil</a>
        <a href="appartements.html">Appartements</a>
        <a href="maisons.html">Maisons</a>
        <a href="contact.html">Contact</a>
    </nav>
    <div class="profile">
        <img src="img/profil.jpg" alt="Profil">
        <div class="profile-menu">
            <ul>
                <li><a href="profil.html">Voir le profil</a></li>
                <li><a href="reservations.html">Mes réservations</a></li>
                <li><a href="parametres.html">Paramètres</a></li>
                <li><a href="deconnexion.html">Déconnexion</a></li>
            </ul>
        </div>
    </div>
</header>

<div class="container">
    <h1>Appartement Cosy à Paris</h1>

    <div class="property-images">
        <button class="arrow arrow-left">&#10094;</button>
        <img src="img/appartementparis.PNG" alt="Salon Appartement Cosy Paris" class="active">
        <img src="img/chambreappartementcosyparis.avif" alt="Chambre Appartement Cosy Paris">
        <img src="img/cusineparis.webp" alt="Cuisine Appartement Cosy Paris">
        <button class="arrow arrow-right">&#10095;</button>
    </div>

    <div class="details">
        <div class="left">
            <h2>Description</h2>
            <p>Ce magnifique appartement cosy situé dans le cœur de Paris vous offre tout le confort nécessaire pour un séjour agréable.</p>
            <div class="amenities">
                <div class="amenity">Wi-Fi</div>
                <div class="amenity">Climatisation</div>
                <div class="amenity">Cuisine équipée</div>
                <div class="amenity">Machine à laver</div>
                <div class="amenity">Balcon</div>
                <div class="amenity">Serrure électronique</div>
            </div>
        </div>
        <div class="right">
            <h2>Prix par nuit</h2>
            <p><strong>120 €</strong></p>
        </div>
    </div>

    <div class="reviews">
        <h2>Avis des visiteurs</h2>
        <!-- Avis clients inchangés -->
    </div>

    <!-- ✅ Formulaire corrigé -->
    <form id="reservationForm">
        <label for="name">Nom:</label>
        <input type="text" id="name" name="nom" required>

        <label for="checkin">Date d'arrivée:</label>
        <input type="date" id="checkin" name="date_arrivee" required>

        <label for="checkout">Date de départ:</label>
        <input type="date" id="checkout" name="date_depart" required>

        <label for="guests">Nombre de personnes:</label>
        <input type="number" id="guests" name="nombre_personnes" min="1" required>

        <input type="hidden" name="id_bien" value="2">
        <button type="submit">Réserver</button>
    </form>

</div>

<footer>
    <p>&copy; 2025 AirLockUnlock. Tous droits réservés.</p>
    <p><a href="politique-confidentialite.html">Politique de confidentialité</a> | <a href="conditions-utilisation.html">Conditions d'utilisation</a></p>
</footer>

<script>
    const images = document.querySelectorAll('.property-images img');
    const leftArrow = document.querySelector('.arrow-left');
    const rightArrow = document.querySelector('.arrow-right');
    let currentIndex = 0;

    function showImage(index) {
        images.forEach((img, i) => {
            img.classList.remove('active');
            if (i === index) img.classList.add('active');
        });
    }

    leftArrow.addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        showImage(currentIndex);
    });

    rightArrow.addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % images.length;
        showImage(currentIndex);
    });

    showImage(currentIndex);

    // ✅ Soumission du formulaire uniquement vers l'API PHP (PAS de PayPal)
    document.getElementById('reservationForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        const formElement = e.target;
        const formData = new FormData(formElement);

        try {
            for (let [key, value] of formData.entries()) {
                console.log(key, value);
            }

            const response = await fetch('http://192.168.1.194:8080/AirlockUnlock/bien/reserver.php', {
                method: 'POST',
                body: formData,
            });

            const contentType = response.headers.get("content-type");

            if (!response.ok) {
                throw new Error(`Erreur HTTP : ${response.status}`);
            }

            const result = await response.json();
            console.log("Réponse JSON :", result);

            if (result.success) {
             alert(result.success);
            } else if (result.error) {
             alert(result.error);
            } else {
             alert("Réponse inattendue : " + JSON.stringify(result));
            }



        } catch (error) {
            console.error('Erreur lors de la requête API:', error);
            alert('Erreur lors de la réservation : ' + error.message);
        }
    });

    // Menu profil
    const profile = document.querySelector('.profile');
    const profileMenu = document.querySelector('.profile-menu');

    profile.addEventListener('click', () => {
        profileMenu.classList.toggle('active');
    });

    document.addEventListener('click', (event) => {
        if (!profile.contains(event.target) && !profileMenu.contains(event.target)) {
            profileMenu.classList.remove('active');
        }
    });
</script>

</body>
</html>
